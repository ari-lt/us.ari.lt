user www-data;
worker_processes auto;
pid /run/nginx.pid;
worker_rlimit_nofile 16384;

events {
    use epoll;
    multi_accept on;
    worker_connections 6144;
}

http {
    include mime.types;
    default_type application/octet-stream;

    access_log off;

    tcp_nopush on;
    tcp_nodelay on;
    keepalive_timeout 120;
    types_hash_max_size 2048;
    server_names_hash_bucket_size 256;

    sendfile on;

    # Fuck are so many IPs pointing to my for
    # https://search.censys.io/hosts/75.119.129.149/data/table?resource=hosts&sort=RELEVANCE&per_page=25&virtual_hosts=EXCLUDE&q=ari.lt&at_time=2024-06-11T18%3A18%3A12.030Z

    server {
        listen 80 default_server;
        listen [::]:80 default_server;

        server_name _;
        server_tokens off;

        access_log off;

        return 403 "ACCESS DENIED: The domain $server_name is not authorised to point to ari.lt!

If you are seeing this, it is most likely that this domain has been pointed to IP address 75.119.129.149 and is not authorized by ARI.LT to do so.

THIS IS CONSIDERED ABUSIVE BEHAVIOR - PLEASE LEAVE THIS WEBSITE IMMEDIATELY.

The actual IP address is owned by Ari Archer <ari@ari.lt> and ARI.LT does not have any relations with this domain and does not authorize the use of this IP address.

Visit the legitimate website at https://ari.lt/";
    }

    # ari.lt

    server {
        listen 80;
        listen [::]:80;

        server_name ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name ari.lt;
        server_tokens off;

        access_log off;

        ssl_certificate /etc/letsencrypt/live/ari.lt/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        location ~ ^/.well-known/matrix/(server|client|support)$ {
            access_log off;

            add_header Content-Type "application/json" always;
            add_header Access-Control-Allow-Origin "*" always;
            add_header Access-Control-Allow-Methods "GET" always;

            alias /var/www/ari-web/matrix/$1;
        }

        location = /.well-known/host-meta {
            add_header Content-Type "application/xrd+xml" always;
            add_header Access-Control-Allow-Origin "*" always;
            add_header Access-Control-Allow-Methods "GET" always;

            alias /var/www/ari-web/xmpp/host-meta;
        }

        location ~ ^/.well-known/(host-meta|xmpp-provider-v2).json$ {
            add_header Content-Type "application/json" always;
            add_header Access-Control-Allow-Origin "*" always;
            add_header Access-Control-Allow-Methods "GET" always;

            alias /var/www/ari-web/xmpp/$1.json;
        }

        location /http-bind {
            access_log off;

            proxy_pass http://127.0.0.1:5280/http-bind;

            proxy_cache_bypass $http_upgrade;
            proxy_http_version 1.1;

            proxy_set_header Host $host;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;

            proxy_connect_timeout 700s;
            proxy_send_timeout 700s;
            proxy_read_timeout 700s;

            proxy_buffering off;
            tcp_nodelay on;
        }

        location /xmpp-websocket {
            access_log off;

            proxy_pass http://127.0.0.1:5280/xmpp-websocket;

            proxy_cache_bypass $http_upgrade;
            proxy_http_version 1.1;

            proxy_set_header Host $host;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;

            proxy_connect_timeout 700s;
            proxy_send_timeout 700s;
            proxy_read_timeout 700s;

            proxy_buffering off;
            tcp_nodelay on;
        }

        location / {
            gzip on;
            gzip_disable "msie6";

            gzip_vary on;
            gzip_proxied any;
            gzip_comp_level 6;
            gzip_buffers 16 8k;
            gzip_http_version 1.1;
            gzip_types image/svg+xml text/plain text/xml text/css text/javascript application/xml application/xhtml+xml application/rss+xml application/javascript application/x-javascript application/x-font-ttf application/vnd.ms-fontobject font/opentype font/ttf font/eot font/otf;

            access_log off;

            proxy_pass http://127.0.0.1:17312;

            proxy_cache_bypass $http_upgrade;
            proxy_http_version 1.1;

            proxy_set_header Host $host;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;

            client_max_body_size 512M;
            proxy_max_temp_file_size 0;
            proxy_buffering off;
        }
    }

    # www.ari.lt

    server {
        listen 80;
        listen [::]:80;

        server_name www.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://ari.lt$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name www.ari.lt;
        server_tokens off;

        access_log off;

        add_header Content-Type "application/json";

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload" always;
        add_header X-Frame-Options "deny" always;
        add_header X-Content-Type-Options "nosniff" always;
        add_header Content-Security-Policy "upgrade-insecure-requests" always;
        add_header X-Permitted-Cross-Domain-Policies "none" always;
        add_header Referrer-Policy "no-referrer" always;

        return 301 https://ari.lt$request_uri;
    }

    # us.ari.lt

    server {
        listen 80;
        listen [::]:80;

        server_name us.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name us.ari.lt;
        server_tokens off;

        gzip on;
        gzip_disable "msie6";

        gzip_vary on;
        gzip_proxied any;
        gzip_comp_level 6;
        gzip_buffers 16 8k;
        gzip_http_version 1.1;
        gzip_types image/svg+xml text/plain text/xml text/css text/javascript application/xml application/xhtml+xml application/rss+xml application/javascript application/x-javascript application/x-font-ttf application/vnd.ms-fontobject font/opentype font/ttf font/eot font/otf;

        access_log off;

        default_type text/plain;

        add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        return 200 "Shut down due to lack of inactivity on 2024-06-04. Contact me until 2024-09-04 if you want an export your data, with proof that you own the account. The data after this period will get deleted:

- E-mail: ari@ari.lt
- Matrix: @ari:ari.lt
- Fedi (Akkoma): @ari@ak.ari.lt

GPG key: https://keys.openpgp.org/vks/v1/by-fingerprint/4FAD63E936B305906A6C4894A50D5B4B599AF8A2

Source code: https://ari.lt/lh/us.ari.lt";
    }

    # matrix.ari.lt

    server {
        listen 80;
        listen [::]:80;

        server_name matrix.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl;
        listen [::]:443 ssl;

        listen 8448 ssl http2;
        listen [::]:8448 ssl http2;

        server_name matrix.ari.lt;
        server_tokens off;

        access_log off;

        add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";
        add_header X-Content-Type-Options "nosniff";

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        location = / {
            access_log off;
            return 301 https://ari.lt/matrix;
        }

        location = /favicon.ico {
            access_log off;
            return 301 https://ari.lt/favicon.ico;
        }

        location ~ ^/git(/.*)?$ {
            access_log off;
            return 301 $scheme://ari.lt/lh/matrix.ari.lt$1$is_args$args;
        }

        location ~ ^/_matrix/media/.*/foxcyb.org/.*$ {
            return 404;
        }

        location ~ ^/_matrix/media/.*/matrix.fokk.in/.*$ {
            return 404;
        }

        location ~ ^(/_matrix|/_synapse/client) {
            access_log off;

            proxy_pass http://127.0.0.1:8008;

            proxy_cache_bypass $http_upgrade;
            proxy_http_version 1.1;

            proxy_set_header Host $host;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $remote_addr;
            proxy_set_header X-Forwarded-Proto $scheme;

            client_max_body_size 512M;
            proxy_max_temp_file_size 0;
            proxy_buffering off;
        }
    }

    # vim-or-emacs.ari.lt

    server {
        listen 80;
        listen [::]:80;

        server_name vim-or-emacs.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name vim-or-emacs.ari.lt;
        server_tokens off;

        gzip on;
        gzip_disable "msie6";

        gzip_vary on;
        gzip_proxied any;
        gzip_comp_level 6;
        gzip_buffers 16 8k;
        gzip_http_version 1.1;
        gzip_types image/svg+xml text/plain text/xml text/css text/javascript application/xml application/xhtml+xml application/rss+xml application/javascript application/x-javascript application/x-font-ttf application/vnd.ms-fontobject font/opentype font/ttf font/eot font/otf;

        access_log off;

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        location / {
            access_log off;

            proxy_pass http://127.0.0.1:8001;

            proxy_cache_bypass $http_upgrade;
            proxy_http_version 1.1;

            proxy_set_header Host $host;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
        }
    }

    # git.ari.lt

    server {
        listen 80;
        listen [::]:80;

        server_name git.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name git.ari.lt;
        server_tokens off;

        add_header Content-Security-Policy "upgrade-insecure-requests";
        add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";
        add_header X-Content-Type-Options "nosniff";

        client_max_body_size 128m;
        client_body_timeout 60;

        proxy_read_timeout 720s;
        proxy_connect_timeout 720s;
        proxy_send_timeout 720s;

        access_log off;

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        location ~ ^/git(/.*)?$ {
            access_log off;
            return 301 $scheme://ari.lt/lh/git.ari.lt$1$is_args$args;
        }

        location / {
            access_log off;
            proxy_redirect off;

            proxy_pass http://127.0.0.1:3000;

            proxy_http_version 1.1;

            proxy_set_header Host $host;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";

            proxy_set_header X-Forwarded-Host $host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_set_header X-Real-IP $remote_addr;

            proxy_max_temp_file_size 0;
            proxy_buffering off;
        }
    }

    # schildi.ari.lt
    # i do not manage this subdomain

    server {
        listen 80;
        listen [::]:80;

        server_name schildi.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name schildi.ari.lt;
        server_tokens off;

        add_header Content-Security-Policy "upgrade-insecure-requests";
        add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";
        add_header X-Content-Type-Options "nosniff";

        access_log off;

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        location ~ ^/git(/.*)?$ {
            access_log off;
            return 301 $scheme://ari.lt/lh/schildi.ari.lt$1$is_args$args;
        }

        location / {
            access_log off;
            root /var/www/schildi;
            autoindex on;
        }
    }

    # cinny.ari.lt
    # i do not manage this subdomain

    server {
        listen 80;
        listen [::]:80;

        server_name cinny.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name cinny.ari.lt;
        server_tokens off;

        access_log off;

        add_header Content-Security-Policy "upgrade-insecure-requests";
        add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";
        add_header X-Content-Type-Options "nosniff";

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        location ~ ^/git(/.*)?$ {
            access_log off;
            return 301 $scheme://ari.lt/lh/cinny.ari.lt$1$is_args$args;
        }

        location / {
            access_log off;
            root /var/www/cinny;
            autoindex on;
        }
    }

    # searx.ari.lt

    server {
        listen 80;
        listen [::]:80;

        server_name searx.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name searx.ari.lt;
        server_tokens off;

        add_header Content-Security-Policy "upgrade-insecure-requests; default-src 'none'; script-src 'self'; style-src 'self'; form-action 'self'; font-src 'self'; frame-ancestors 'self'; base-uri 'self'; connect-src 'self' https://overpass-api.de; img-src 'self' data: https://*.tile.openstreetmap.org; frame-src https://www.youtube-nocookie.com https://player.vimeo.com https://www.dailymotion.com https://www.deezer.com https://www.mixcloud.com https://w.soundcloud.com https://embed.spotify.com";
        add_header X-Content-Type-Options "nosniff";

        client_max_body_size 128m;
        client_body_timeout 60;

        proxy_read_timeout 720s;
        proxy_connect_timeout 720s;
        proxy_send_timeout 720s;

        access_log off;

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        location ~ ^/git(/.*)?$ {
            access_log off;
            return 301 $scheme://ari.lt/lh/searx.ari.lt$1$is_args$args;
        }

        location / {
            access_log off;

            proxy_pass http://127.0.0.1:8888;

            proxy_http_version 1.1;

            proxy_set_header Host $host;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";

            proxy_set_header X-Forwarded-Host $host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_set_header X-Real-IP $remote_addr;

            proxy_max_temp_file_size 0;
            proxy_buffering off;
        }
    }

    # pb.ari.lt
    # i do not manage this subdomain

    server {
        listen 80;
        listen [::]:80;

        server_name pb.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name pb.ari.lt;

        access_log off;
        server_tokens off;

        add_header Content-Security-Policy "upgrade-insecure-requests";
        add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";
        add_header X-Content-Type-Options "nosniff";

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        root /var/www/privatebin;
        index index.php index.html index.htm;

        location ~ ^/git(/.*)?$ {
            access_log off;
            return 301 $scheme://ari.lt/lh/pb.ari.lt$1$is_args$args;
        }

        location / {
            try_files $uri $uri/ =404;
        }

        location ~ \.php$ {
            include snippets/fastcgi-php.conf;
            fastcgi_pass unix:/run/php/php-fpm.sock;
            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
            include fastcgi_params;
        }
    }

    # pad.ari.lt

    server {
        listen 80;
        listen [::]:80;

        server_name pad.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name pad.ari.lt;
        server_tokens off;

        access_log off;

        add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        location ~ ^/git(/.*)?$ {
            access_log off;
            return 301 $scheme://ari.lt/lh/pad.ari.lt$1$is_args$args;
        }

        location /cryptpad_websocket {
            access_log off;

            proxy_pass http://127.0.0.1:8176;

            proxy_http_version 1.1;

            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;

            proxy_connect_timeout 700s;
            proxy_send_timeout 700s;
            proxy_read_timeout 700s;

            proxy_max_temp_file_size 0;
            proxy_buffering off;
        }

        location / {
            access_log off;

            proxy_pass http://127.0.0.1:8174;

            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header Host $host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            client_max_body_size 150m;

            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection upgrade;

            proxy_max_temp_file_size 0;
            proxy_buffering off;
        }
    }

    # spad.ari.lt

    server {
        listen 80;
        listen [::]:80;

        server_name spad.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name spad.ari.lt;
        server_tokens off;

        access_log off;

        add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        location / {
            access_log off;

            proxy_pass http://127.0.0.1:8174;

            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header Host $host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            client_max_body_size 150m;

            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection upgrade;

            proxy_max_temp_file_size 0;
            proxy_buffering off;
        }
    }

    # mail.ari.lt

    server {
        listen 80;
        listen [::]:80;

        server_name mail.ari.lt autoconfig.ari.lt autodiscover.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name mail.ari.lt autoconfig.ari.lt autodiscover.ari.lt;
        server_tokens off;

        access_log off;

        add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        location ~ ^/git(/.*)?$ {
            access_log off;
            return 301 $scheme://ari.lt/lh/mail.ari.lt$1$is_args$args;
        }

        location ~ ^/(signup|static)(/.*)?$ {
            access_log off;

            proxy_pass http://127.0.0.1:13912;

            proxy_cache_bypass $http_upgrade;
            proxy_http_version 1.1;

            proxy_set_header Host $host;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;

            client_max_body_size 150m;

            proxy_max_temp_file_size 0;
            proxy_buffering off;
        }

        location / {
            access_log off;

            proxy_pass http://127.0.0.1:17281;

            proxy_cache_bypass $http_upgrade;
            proxy_http_version 1.1;

            proxy_set_header Host $host;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;

            client_max_body_size 150m;

            proxy_max_temp_file_size 0;
            proxy_buffering off;
        }
    }

    # rc.ari.lt

    server {
        listen 80;
        listen [::]:80;

        server_name rc.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name rc.ari.lt;
        server_tokens off;

        access_log off;

        add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        root /var/www/roundcubemail/;

        index index.php index.html index.htm index.nginx-debian.html;

        location ~ ^/git(/.*)?$ {
            access_log off;
            return 301 $scheme://ari.lt/lh/rc.ari.lt$1$is_args$args;
        }

        location / {
            try_files $uri $uri/ =404;
        }

        error_page 404 /404.html;
        error_page 500 502 503 504 /50x.html;

        location = /50x.html {
            root /usr/share/nginx/html;
        }

        location ~ \.php$ {
            include snippets/fastcgi-php.conf;
            fastcgi_pass unix:/var/run/php/php8.2-fpm.sock;
            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
            include fastcgi_params;
        }

        location ~ /\.ht {
            deny all;
        }

        location ~ /.well-known {
            allow all;
        }

        location ~ /\.ht {
            deny all;
        }
    }

    # s.ari.lt

    server {
        listen 80;
        listen [::]:80;

        server_name s.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name s.ari.lt;
        server_tokens off;

        default_type text/plain;

        access_log off;

        add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        return 200 "- English: This is the ari.lt VPS (Virtual Private Server). See https://ari.lt/lh for more details. Contacts:
- Lietuviu: Tai ari.lt VPS (Virtualus Privatus Serveris). Daugiau informacijos rasite https://ari.lt/lh. Kontaktai:
- Deutsch: Dies ist der ari.lt VPS (Virtual Private Server). Weitere Informationen finden Sie unter https://ari.lt/lh. Kontakte:
- Francais: Il s'agit du VPS (Virtual Private Server) ari.lt. Voir https://ari.lt/lh pour plus de details. Contacts:
- Espanol: Este es el VPS (Servidor Privado Virtual) de ari.lt. Consulte https://ari.lt/lh para obtener mas detalles. Contactos:
- Nederlands (https://cabbagecorp.nl/): Dit is de ari.lt VPS (Virtual Private Server). Vind meer informatie op https://ari.lt/lh. Contacten:

- E-mail: ari@ari.lt
- Matrix: @ari:ari.lt
- Fedi (Akkoma): @ari@ak.ari.lt

GPG key: https://keys.openpgp.org/vks/v1/by-fingerprint/4FAD63E936B305906A6C4894A50D5B4B599AF8A2

You're free to add other translations. Contact me :)";
    }

    # db.cubiq.dev
    # i help to host this

    server {
        listen 80;
        listen [::]:80;

        server_name db.cubiq.dev;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name db.cubiq.dev;
        server_tokens off;

        default_type text/plain;

        access_log off;

        ssl_certificate /etc/letsencrypt/live/db.cubiq.dev/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/db.cubiq.dev/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/db.cubiq.dev/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        location / {
            access_log off;

            proxy_pass http://127.0.0.1:10212;

            proxy_cache_bypass $http_upgrade;
            proxy_http_version 1.1;

            proxy_set_header Host $host;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;

            client_max_body_size 512M;
            proxy_max_temp_file_size 0;
            proxy_buffering off;
        }
    }

    # quotes.ari.lt

    server {
        listen 80;
        listen [::]:80;

        server_name quotes.ari.lt;  # or whatever domain you use
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name quotes.ari.lt;
        server_tokens off;

        access_log off;

        # letsencrypt ssl certs - you don't have to use LE, but this is just an example
        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        location ~ ^/git(/.*)?$ {
            access_log off;
            return 301 $scheme://ari.lt/gh/imag$1$is_args$args;
        }

        location / {
            access_log off;

            proxy_pass http://127.0.0.1:19721;  # or wherever your app is running

            proxy_cache_bypass $http_upgrade;
            proxy_http_version 1.1;

            proxy_set_header Host $host;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;

            client_max_body_size 512M;
            proxy_max_temp_file_size 0;
            proxy_buffering off;
        }
    }

    # ak.ari.lt & ak-media.ari.lt

    proxy_cache_path /tmp/akkoma-media-cache levels=1:2 keys_zone=akkoma_media_cache:10m max_size=10g inactive=720m use_temp_path=off;

    upstream phoenix {
        server 127.0.0.1:38173 max_fails=5 fail_timeout=60s;
    }

    server {
        listen 80;
        listen [::]:80;

        server_name ak.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    ssl_session_cache shared:ssl_session_cache:10m;

    server {
        server_name ak.ari.lt;

        listen 443 ssl http2;
        listen [::]:443 ssl http2;
        server_tokens off;

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_ecdh_curve X25519:prime256v1:secp384r1:secp521r1;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        gzip_vary on;
        gzip_proxied any;
        gzip_comp_level 6;
        gzip_buffers 16 8k;
        gzip_http_version 1.1;
        gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript application/activity+json application/atom+xml;

        client_max_body_size 16m;
        ignore_invalid_headers off;

        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $http_host;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;

        location ~ ^/favicon.(ico|png|jpg|jpeg)$ {
            access_log off;
            add_header Access-Control-Allow-Origin "*";
            add_header Access-Control-Allow-Methods "GET, POST, OPTIONS, HEAD";
            alias /var/www/ari-web.png;
        }

        location ~ ^/(media|proxy) {
            return 404;
        }

        location / {
            proxy_pass http://phoenix;

            client_max_body_size 512M;
            proxy_max_temp_file_size 0;
            proxy_buffering off;
        }
    }

    server {
        listen 80;
        listen [::]:80;

        server_name ak-media.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        server_name ak-media.ari.lt;

        listen 443 ssl http2;
        listen [::]:443 ssl http2;
        server_tokens off;

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_ecdh_curve X25519:prime256v1:secp384r1:secp521r1;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        gzip_vary on;
        gzip_proxied any;
        gzip_comp_level 6;
        gzip_buffers 16 8k;
        gzip_http_version 1.1;
        gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript application/activity+json application/atom+xml;

        client_max_body_size 16m;
        ignore_invalid_headers off;

        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $http_host;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;

        location ~ ^/favicon.(ico|png|jpg|jpeg)$ {
            access_log off;
            add_header Access-Control-Allow-Origin "*";
            add_header Access-Control-Allow-Methods "GET, POST, OPTIONS, HEAD";
            alias /var/www/ari-web.png;
        }

        location ~ ^/(media|proxy) {
            proxy_cache        akkoma_media_cache;
            slice              1m;
            proxy_cache_key    $host$uri$is_args$args$slice_range;
            proxy_set_header   Range $slice_range;
            proxy_cache_valid  200 206 301 304 1h;
            proxy_cache_lock   on;
            proxy_ignore_client_abort on;
            chunked_transfer_encoding on;
            proxy_pass         http://phoenix;

            client_max_body_size 512M;
            proxy_max_temp_file_size 0;
            proxy_buffering off;
        }

        location / {
            return 404;
        }
    }

    # vi.ari.lt

    server {
        listen 80;
        listen [::]:80;

        server_name vi.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl;
        listen [::]:443 ssl;

        server_name vi.ari.lt;
        server_tokens off;

        access_log off;

        add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";
        add_header X-Content-Type-Options "nosniff";

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        location ~ ^/git(/.*)?$ {
            access_log off;
            return 301 $scheme://ari.lt/lh/vi.ari.lt$1$is_args$args;
        }

        location / {
            access_log off;

            proxy_pass http://127.0.0.1:18729;

            proxy_cache_bypass $http_upgrade;
            proxy_http_version 1.1;

            proxy_set_header Host $host;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $remote_addr;
            proxy_set_header X-Forwarded-Proto $scheme;

            client_max_body_size 512M;
            proxy_max_temp_file_size 0;
            proxy_buffering off;
        }
    }

    # git.kappach.at

    server {
        listen 80;
        listen [::]:80;

        server_name git.kappach.at;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name git.kappach.at;
        server_tokens off;

        add_header Content-Security-Policy "upgrade-insecure-requests";
        add_header X-Content-Type-Options "nosniff";

        client_max_body_size 128m;
        client_body_timeout 60;

        proxy_read_timeout 720s;
        proxy_connect_timeout 720s;
        proxy_send_timeout 720s;

        access_log off;

        ssl_certificate /etc/letsencrypt/live/git.kappach.at/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/git.kappach.at/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/git.kappach.at/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        location / {
            access_log off;
            proxy_redirect off;

            proxy_pass http://127.0.0.1:1234;

            proxy_http_version 1.1;

            proxy_set_header Host $host;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";

            proxy_set_header X-Forwarded-Host $host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_set_header X-Real-IP $remote_addr;

            proxy_max_temp_file_size 0;
            proxy_buffering off;
        }
    }

    # trie.ari.lt

    server {
        listen 80;
        listen [::]:80;

        server_name trie.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name trie.ari.lt;
        server_tokens off;

        access_log off;

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        location / {
            access_log off;

            proxy_pass http://127.0.0.1:27123;

            proxy_cache_bypass $http_upgrade;
            proxy_http_version 1.1;

            proxy_set_header Host $host;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;

            client_max_body_size 512M;
            proxy_max_temp_file_size 0;
            proxy_buffering off;
        }
    }

    # blog.ari.lt

    server {
        listen 80;
        listen [::]:80;

        server_name blog.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name blog.ari.lt;
        server_tokens off;

        access_log off;

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload" always;
        add_header X-Frame-Options "deny" always;
        add_header X-Content-Type-Options "nosniff" always;
        add_header Content-Security-Policy "upgrade-insecure-requests" always;
        add_header X-Permitted-Cross-Domain-Policies "none" always;
        add_header Referrer-Policy "no-referrer" always;

        gzip on;
        gzip_disable "msie6";

        gzip_vary on;
        gzip_proxied any;
        gzip_comp_level 6;
        gzip_buffers 16 8k;
        gzip_http_version 1.1;
        gzip_types image/svg+xml text/plain text/xml text/css text/javascript application/xml application/xhtml+xml application/rss+xml application/javascript application/x-javascript application/x-font-ttf application/vnd.ms-fontobject font/opentype font/ttf font/eot font/otf;

        rewrite ^/git/(.*)$ https://ari.lt/lh/blog.ari.lt/$1 permanent;

        location = /favicon.ico {
            return 200 https://ari.lt/favicon.ico;
        }

        rewrite ^/blogs/(.*)$ https://legacy.blog.ari.lt/blogs/$1 permanent;
        rewrite ^/c$ https://user.ari.lt/ permanent;

        location = /netlify.toml {
            return 404 https://ari.lt/404.blog.xyz;
        }

        rewrite ^/visit$ https://us.ari.lt/counter/@ari/kpnuBU0qISQlfR7cSNwwg9oW8654-RguVrXh9JOBGo3EP1-bm7aF9ROuQO6Jqesk.svg?fill=%23f9f6e8 permanent;

        error_page 404 https://ari.lt/404.blog.xyz;

        add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";
        add_header X-Frame-Options "deny";
        add_header X-Content-Type-Options "nosniff";
        add_header Content-Security-Policy "upgrade-insecure-requests";
        add_header X-Permitted-Cross-Domain-Policies "none";
        add_header Referrer-Policy "no-referrer";

        location = /rss.xml {
            root /var/www/ari-web/blog.ari.lt;
            add_header Content-Type "application/xml+rss";
            try_files $uri =404;
        }

        location = /blog.json {
            root /var/www/ari-web/blog.ari.lt;
            add_header Access-Control-Allow-Origin "*";
            add_header Access-Control-Allow-Methods "GET";
            try_files $uri =404;
        }

        location = /blog_json_hash.txt {
            root /var/www/ari-web/blog.ari.lt;
            add_header Access-Control-Allow-Origin "*";
            add_header Access-Control-Allow-Methods "GET";
            try_files $uri =404;
        }

        location = /recents_json_hash.txt {
            root /var/www/ari-web/blog.ari.lt;
            add_header Access-Control-Allow-Origin "*";
            add_header Access-Control-Allow-Methods "GET";
            try_files $uri =404;
        }

        location = /recents.json {
            root /var/www/ari-web/blog.ari.lt;
            add_header Access-Control-Allow-Origin "*";
            add_header Access-Control-Allow-Methods "GET";
            try_files $uri =404;
        }

        location / {
            root /var/www/ari-web/blog.ari.lt;
            index index.html;
            try_files $uri $uri/ =404;
        }
    }

    # files.ari.lt

    server {
        listen 80;
        listen [::]:80;

        server_name files.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name files.ari.lt;
        server_tokens off;

        access_log off;

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        rewrite ^/git/(.*)$ https://ari.lt/lh/files.ari.lt/$1 permanent;
        location = /favicon.ico {
            return 200 https://ari.lt/favicon.ico;
        }
        location = /robots.txt {
            return 200 https://ari.lt/robots.txt;
        }
        location = /sitemap.xml {
            return 200 https://ari.lt/sitemap.xml;
        }
        location = /netlify.toml {
            return 404 https://ari.lt/404.files.xyz;
        }
        error_page 404 https://ari.lt/404.files.xyz;

        # Headers for specific files

        location = /files.json {
            root /var/www/ari-web/blog.ari.lt;
            add_header Access-Control-Allow-Origin "*";
            add_header Access-Control-Allow-Methods "GET";
            try_files $uri =404;
        }

        location = /files_json_hash.txt {
            root /var/www/ari-web/blog.ari.lt;
            add_header Access-Control-Allow-Origin "*";
            add_header Access-Control-Allow-Methods "GET";
            try_files $uri =404;
        }

        # Global headers

        add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";
        add_header Access-Control-Allow-Origin "*";
        add_header Access-Control-Allow-Methods "GET";
        add_header X-Frame-Options "deny";
        add_header X-Content-Type-Options "nosniff";
        add_header Content-Security-Policy "upgrade-insecure-requests";
        add_header X-Permitted-Cross-Domain-Policies "none";
        add_header Referrer-Policy "no-referrer";

        # Handling static content

        location / {
            root /var/www/ari-web/files.ari.lt;
            index index.html;
            try_files $uri $uri/ =404;
        }
    }

    # user.ari.lt

    server {
        listen 80;
        listen [::]:80;

        server_name user.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name user.ari.lt;
        server_tokens off;

        access_log off;

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        error_page 404 https://ari.lt/404.files.xyz;
        rewrite ^/git/(.*)$ https://ari.lt/lh/user.ari.lt/$1 permanent;

        # Redirect specific files to another URL
        location = /favicon.ico {
            return 200 https://ari.lt/favicon.ico;
        }

        location = /robots.txt {
            return 200 https://ari.lt/robots.txt;
        }

        location = /sitemap.xml {
            return 200 https://ari.lt/sitemap.xml;
        }

        location = /netlify.toml {
            return 404 https://ari.lt/404.files.xyz;
        }

        # Headers for specific file
        location = /content/js/linkify.js {
            root /var/www/ari-web/user.ari.lt;
            add_header Access-Control-Allow-Origin "ari.lt";
            add_header Access-Control-Allow-Methods "GET, HEAD, OPTIONS";
            try_files $uri $uri/ =404;
        }

        # Global headers

        add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";
        add_header Access-Control-Allow-Origin "*";
        add_header Access-Control-Allow-Methods "GET";
        add_header X-Frame-Options "deny";
        add_header X-Content-Type-Options "nosniff";
        add_header Content-Security-Policy "upgrade-insecure-requests";
        add_header X-Permitted-Cross-Domain-Policies "none";
        add_header Referrer-Policy "no-referrer";

        # Handling static content

        location / {
            root /var/www/ari-web/user.ari.lt;
            index index.html;
            try_files $uri $uri/ =404;
        }
    }

    # status.fsky.io

    server {
        listen 80;
        listen [::]:80;

        server_name status.fsky.io;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name status.fsky.io;
        server_tokens off;

        access_log off;

        ssl_certificate /etc/letsencrypt/live/status.fsky.io/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/status.fsky.io/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/status.fsky.io/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        gzip on;
        gzip_disable "msie6";

        gzip_vary on;
        gzip_proxied any;
        gzip_comp_level 6;
        gzip_buffers 16 8k;
        gzip_http_version 1.1;
        gzip_types image/svg+xml text/plain text/xml text/css text/javascript application/xml application/xhtml+xml application/rss+xml application/javascript application/x-javascript application/x-font-ttf application/vnd.ms-fontobject font/opentype font/ttf font/eot font/otf;

        location / {
            access_log off;

            proxy_pass http://127.0.0.1:18212;

            proxy_cache_bypass $http_upgrade;
            proxy_http_version 1.1;

            proxy_set_header Host $host;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;

            client_max_body_size 512M;
            proxy_max_temp_file_size 0;
            proxy_buffering off;
        }
    }

    # muc.ari.lt, ps.ari.lt, and ht.ari.lt

    server {
        listen 80;
        listen [::]:80;

        server_name muc.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name muc.ari.lt;
        server_tokens off;

        access_log off;

        add_header Content-Security-Policy "upgrade-insecure-requests";
        add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";
        add_header X-Content-Type-Options "nosniff";

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        return 301 https://ari.lt/;
    }

    server {
        listen 80;
        listen [::]:80;

        server_name ps.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name ps.ari.lt;
        server_tokens off;

        access_log off;

        add_header Content-Security-Policy "upgrade-insecure-requests";
        add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";
        add_header X-Content-Type-Options "nosniff";

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        return 301 https://ari.lt/;
    }

    server {
        listen 80;
        listen [::]:80;

        server_name ht.ari.lt;
        server_tokens off;

        access_log off;

        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;

        server_name ht.ari.lt;
        server_tokens off;

        access_log off;

        add_header Content-Security-Policy "upgrade-insecure-requests";
        add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";
        add_header X-Content-Type-Options "nosniff";

        ssl_certificate /etc/letsencrypt/live/ari.lt-0001/fullchain.pem;
        ssl_certificate_key /etc/letsencrypt/live/ari.lt-0001/privkey.pem;
        ssl_trusted_certificate /etc/letsencrypt/live/ari.lt-0001/chain.pem;

        ssl_stapling on;
        ssl_stapling_verify on;
        ssl_session_timeout 1d;
        ssl_session_cache shared:MozSSL:10m;
        ssl_session_tickets off;
        ssl_protocols TLSv1.2 TLSv1.3;
        ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';
        ssl_prefer_server_ciphers on;

        location / {
            access_log off;

            proxy_pass http://127.0.0.1:5280;

            proxy_cache_bypass $http_upgrade;
            proxy_http_version 1.1;

            proxy_set_header Host $host;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;

            proxy_buffering off;
            tcp_nodelay on;
        }
    }
}
